[tools]

[env]

[tasks.game]
description = "Run the game"
run = "godot --path . --print-fps"

[tasks.godot]
description = "Run the Godot editor"
run = "(godot --path . --editor >& /dev/null &)"

[tasks.gut]
alias = "test"
description = "Run the GUT tests"
run = "godot --path . --headless --debug --script addons/gut/gut_cmdln.gd -gexit"

[tasks.export-web]
description = "Export the web version to export/web/"
run = """
#!/usr/bin/env bash
set -ex

rm -rf export/web
mkdir -p export
mkdir export/web
godot --headless --export-release "Web" export/web/index.html
"""

[tasks.deploy-web]
description = "Deploy the web version to void.docwhat.org"
run = "rsync -av --delete-after --progress export/web/ gerf:/srv/website/srv/void/"

[tasks.export-macos]
description = "Export the macOS version to export/macos/"
run = """
#!/usr/bin/env bash
set -ex

rm -rf export/macos
mkdir -p export
mkdir export/macos
godot --headless --export-release "macOS" export/macos/void.app
"""

[tasks.export-windows]
description = "Export the Windows version to export/windows/"
run = """
#!/usr/bin/env bash
set -ex

rm -rf export/windows
mkdir -p export
mkdir export/windows
godot --headless --export-release "Windows Desktop" export/windows/void.exe
"""

[tasks.export-linux]
description = "Export the Linux version to export/linux/"
run = """
#!/usr/bin/env bash
set -ex

rm -rf export/linux
mkdir -p export
mkdir export/linux
godot --headless --export-release "Linux" export/linux/void
"""

[tasks.export-all]
description = "Export all platforms to export/"
depends = ["export-web", "export-macos", "export-windows", "export-linux"]

[tasks.clean]
description = "Clean all exported builds and other cruft"
run = "rm -rf export"

# EOF
